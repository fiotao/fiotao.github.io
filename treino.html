<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>FitTracker - Acompanhamento de Treino</title>
    <style>
        :root {
            --primary-color: #1A2A3A;
            --secondary-color: #FF7F50;
            --light-color: #f8f9fa;
            --dark-color: #343a40;
            --success-color: #28a745;
            --info-color: #17a2b8;
            --danger-color: #dc3545;
        }

        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
        }

        body {
            background-color: #f5f5f5;
            color: var(--dark-color);
            line-height: 1.6;
            display: flex;
            flex-direction: column;
            min-height: 100vh;
        }

        .container {
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            background-color: #fff;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
            border-radius: 8px;
            flex-grow: 1;
            display: flex;
            flex-direction: column;
        }

        header {
            background-color: var(--primary-color);
            color: var(--light-color);
            padding: 15px 0;
            text-align: center;
            margin-bottom: 20px;
            border-radius: 8px 8px 0 0;
        }

        header h1 {
            margin: 0;
            font-size: 1.8em;
        }

        .section-title {
            font-size: 1.5em;
            color: var(--primary-color);
            margin-bottom: 15px;
            border-bottom: 2px solid var(--secondary-color);
            padding-bottom: 5px;
        }

        /* Workout Days View */
        #days-view {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
            gap: 15px;
            margin-bottom: 20px;
        }

        .day-card {
            background-color: var(--light-color);
            border: 1px solid #ddd;
            border-radius: 8px;
            padding: 15px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .day-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);
            background-color: var(--secondary-color);
            color: var(--light-color);
        }

        .day-card.completed {
            background-color: var(--success-color);
            color: var(--light-color);
            border-color: var(--success-color);
        }

        /* Exercises View */
        #exercises-view {
            display: none; /* Hidden by default */
            flex-grow: 1;
            flex-direction: column;
        }

        .exercise-list {
            list-style: none;
            padding: 0;
            margin-top: 15px;
            flex-grow: 1;
            overflow-y: auto; /* Scroll for long lists */
        }

        .exercise-item {
            background-color: var(--light-color);
            border: 1px solid #eee;
            border-radius: 5px;
            margin-bottom: 10px;
            padding: 15px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap; /* Allow wrapping for smaller screens */
        }

        .exercise-item.completed {
            background-color: #e6ffe6; /* Light green for completed */
            border-color: var(--success-color);
        }

        .exercise-img {
            width: 80px; /* Adjust as needed */
            height: 80px; /* Adjust as needed */
            object-fit: cover;
            border-radius: 5px;
            margin-right: 15px;
            flex-shrink: 0; /* Prevent image from shrinking */
        }

        .exercise-details {
            flex-grow: 1;
            margin-right: 10px;
        }

        .exercise-details h3 {
            margin: 0 0 5px 0;
            color: var(--primary-color);
        }

        .exercise-details p {
            margin: 0;
            font-size: 0.9em;
            color: var(--dark-color);
        }
        
        .exercise-details .description {
            font-style: italic;
            color: #666;
            margin-top: 5px;
        }

        .exercise-details .muscle-group {
            font-weight: bold;
            color: var(--secondary-color);
            margin-top: 5px;
        }

        .exercise-details .video-link {
            display: block;
            margin-top: 5px;
            color: var(--info-color);
            text-decoration: none;
        }

        .exercise-details .video-link:hover {
            text-decoration: underline;
        }

        .exercise-actions {
            display: flex;
            gap: 10px;
            margin-top: 10px; /* Space out on wrap */
        }

        .btn {
            padding: 8px 15px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 0.9em;
            transition: background-color 0.3s ease;
        }

        .btn-primary {
            background-color: var(--primary-color);
            color: var(--light-color);
        }

        .btn-primary:hover {
            background-color: #0d1a26;
        }

        .btn-success {
            background-color: var(--success-color);
            color: var(--light-color);
        }

        .btn-success:hover {
            background-color: #218838;
        }

        .btn-info {
            background-color: var(--info-color);
            color: var(--light-color);
        }

        .btn-info:hover {
            background-color: #117a8b;
        }

        .btn-danger {
            background-color: var(--danger-color);
            color: var(--light-color);
        }

        .btn-danger:hover {
            background-color: #c82333;
        }

        .alert {
            padding: 10px 15px;
            border-radius: 5px;
            margin-bottom: 15px;
            font-size: 0.9em;
            opacity: 0;
            transition: opacity 0.5s ease-in-out;
        }

        .alert.show {
            opacity: 1;
        }

        .alert-success {
            background-color: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }

        .alert-danger {
            background-color: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }

        .alert-info {
            background-color: #d1ecf1;
            color: #0c5460;
            border: 1px solid #bee5eb;
        }

        /* Timer */
        #timer {
            text-align: center;
            margin-top: 20px;
            font-size: 2em;
            color: var(--primary-color);
            display: none; /* Hidden by default */
        }

        #timer.resting {
            color: var(--danger-color);
        }

        #timer-controls {
            display: flex;
            justify-content: center;
            gap: 10px;
            margin-top: 10px;
        }

        /* Footer */
        footer {
            text-align: center;
            padding: 15px;
            margin-top: 20px;
            background-color: var(--dark-color);
            color: var(--light-color);
            border-radius: 0 0 8px 8px;
            font-size: 0.9em;
        }

        /* Navigation */
        .nav-buttons {
            display: flex;
            justify-content: space-between;
            margin-bottom: 15px;
        }

        #back-button {
            display: none; /* Hidden by default */
        }

        /* Next Exercise Display */
        #next-exercise-display {
            background-color: var(--info-color);
            color: var(--light-color);
            padding: 10px 15px;
            border-radius: 5px;
            margin-bottom: 15px;
            text-align: center;
            font-weight: bold;
            display: none; /* Initially hidden */
        }

        #next-exercise-display.show {
            display: block;
        }

        @media (max-width: 600px) {
            .container {
                padding: 15px;
                margin: 10px;
            }

            header h1 {
                font-size: 1.5em;
            }

            .day-card {
                padding: 10px;
            }

            .exercise-item {
                flex-direction: column;
                align-items: flex-start;
            }

            .exercise-img {
                margin-bottom: 10px; /* Add space below image when stacked */
                margin-right: 0; /* Remove right margin when stacked */
            }

            .exercise-actions {
                margin-top: 15px;
                width: 100%;
                justify-content: stretch;
            }

            .btn {
                flex-grow: 1;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>FitTracker</h1>
        </header>

        <div id="alert-container"></div>

        <nav class="nav-buttons">
            <button id="back-button" class="btn btn-primary">← Voltar</button>
            <button id="register-workout-button" class="btn btn-success" style="display: none;">Registrar Treino do Dia</button>
        </nav>

        <div id="next-exercise-display">
            Próximo Exercício: <span id="next-exercise-name">N/A</span>
        </div>

        <section id="days-view">
            <h2 class="section-title">Escolha o Dia do Treino</h2>
            <div id="workout-days">
                <!-- Workout days will be loaded here by JavaScript -->
            </div>
        </section>

        <section id="exercises-view">
            <h2 class="section-title">Exercícios do Dia <span id="current-day-name"></span></h2>
            <ul id="exercise-list" class="exercise-list">
                <!-- Exercises will be loaded here by JavaScript -->
            </ul>
            <div id="timer">
                Tempo de Descanso: <span id="countdown">00:00</span>
                <div id="timer-controls">
                    <button id="skip-rest" class="btn btn-info">Pular Descanso</button>
                    <button id="add-30-sec" class="btn btn-info">+30s</button>
                </div>
            </div>
        </section>
    </div>

    <footer>
        <p>&copy; 2024 FitTracker. Todos os direitos reservados.</p>
    </footer>

    <script>
        const workoutDaysContainer = document.getElementById('workout-days');
        const daysView = document.getElementById('days-view');
        const exercisesView = document.getElementById('exercises-view');
        const currentDayName = document.getElementById('current-day-name');
        const exerciseList = document.getElementById('exercise-list');
        const backButton = document.getElementById('back-button');
        const registerWorkoutButton = document.getElementById('register-workout-button');
        const timerElement = document.getElementById('timer');
        const countdownElement = document.getElementById('countdown');
        const skipRestButton = document.getElementById('skip-rest');
        const add30SecButton = document.getElementById('add-30-sec');
        const alertContainer = document.getElementById('alert-container');
        const nextExerciseDisplay = document.getElementById('next-exercise-display');
        const nextExerciseNameElement = document.getElementById('next-exercise-name');


        let workoutProgress = {}; // Stores completion status for each exercise
        let workoutHistory = []; // Stores completed workout days
        let currentDay = null; // Will now store the numerical day (e.g., 1, 2, 3)
        let timerInterval;
        let secondsRemaining = 0;
        let resting = false;
        let currentExercises = []; // Stores exercises for the current day

        // Define your workout structure here with local image paths and new fields
        const workoutData = [
            {
                day: 1,
                title: "Peito, ombro, tríceps e antebraço",
                image: "https://images.unsplash.com/photo-1594915447192-d62153549646?q=80&w=1770&auto=format&fit=crop&ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D",
                exercises: [
                    {
                        name: "Supino máquina", sets: 3, reps: "6-8",
                        image: "./images/supino_maquina.png",
                        description: "Foco no peitoral e ombros, com segurança da máquina.",
                        videoUrl: "https://musclewiki.com/exercises/female/chest",
                        muscleGroup: "Peito, Ombro, Tríceps"
                    },
                    {
                        name: "Supino inclinado", sets: 2, reps: "8-10",
                        image: "./images/supino_inclinado.png",
                        description: "Trabalha a parte superior do peitoral.",
                        videoUrl: "https://musclewiki.com/barbell/male/anterior-deltoid/barbell-incline-bench-press/",
                        muscleGroup: "Peito (Superior), Ombro, Tríceps"
                    },
                    {
                        name: "Crucifixo com halter", sets: 2, reps: "8-12",
                        image: "./images/cruxifixo_halter.png",
                        description: "Isolamento do peitoral, alongando as fibras musculares.",
                        videoUrl: "https://www.youtube.com/watch?v=_kpKlYexyXs",
                        muscleGroup: "Peito"
                    },
                    {
                        name: "Desenvolvimento com halteres", sets: 3, reps: "6-10",
                        image: "./images/desenvolvimento_halteres.png",
                        description: "Exercício composto para ombros, trabalha deltoides.",
                        videoUrl: "https://musclewiki.com/dumbbells/male/shoulders/dumbbell-shoulder-press/",
                        muscleGroup: "Ombro, Tríceps"
                    },
                    {
                        name: "Elevação lateral", sets: 3, reps: "10-12",
                        image: "./images/elevacao_lateral.png",
                        description: "Isolamento deltoide lateral para maior largura.",
                        videoUrl: "https://musclewiki.com/dumbbells/male/shoulders/dumbbell-lateral-raise/",
                        muscleGroup: "Ombro"
                    },
                    {
                        name: "Tríceps paralela", sets: 3, reps: "8-12",
                        image: "./images/triceps_paralela.png",
                        description: "Exercício eficaz para o tríceps, pode ser feito em máquina ou barra.",
                        videoUrl: "https://www.youtube.com/watch?v=dQw4w9WgXcQ",
                        muscleGroup: "Tríceps"
                    },
                    {
                        name: "Tríceps francês na polia", sets: 2, reps: "8-12",
                        image: "./images/triceps_frances.png",
                        description: "Foco na cabeça longa do tríceps.",
                        videoUrl: "https://musclewiki.com/pt-br/cables/male/triceps/cable-rope-overhead-tricep-extension/",
                        muscleGroup: "Tríceps"
                    },
                    {
                        name: "Rosca punho inversa", sets: 3, reps: "12-15",
                        image: "./images/rosca_punho_inversa.png",
                        description: "Fortalecimento dos extensores do antebraço.",
                        videoUrl: "https://www.youtube.com/watch?v=EA7u4Q_8j0I",
                        muscleGroup: "Antebraço"
                    },
                    {
                        name: "Rosca punho", sets: 3, reps: "12-15",
                        image: "./images/rosca_punho.png",
                        description: "Fortalecimento dos flexores do antebraço.",
                        videoUrl: "https://www.youtube.com/watch?v=EA7u4Q_8j0I",
                        muscleGroup: "Antebraço"
                    }
                ]
            },
            {
                day: 2,
                title: "Costas, bíceps e ombro",
                image: "https://images.unsplash.com/photo-1549476468-382a93796d11?q=80&w=1770&auto=format&fit=crop&ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D",
                exercises: [
                    {
                        name: "Puxada triângulo", sets: 3, reps: "6-8",
                        image: "./images/puxada_triangulo.png",
                        description: "Trabalha a largura das costas, com foco nos dorsais.",
                        videoUrl: "https://musclewiki.com/barbell/male/biceps/barbell-bent-over-row",
                        muscleGroup: "Costas, Bíceps"
                    },
                    {
                        name: "Remada curvada", sets: 3, reps: "6-10",
                        image: "./images/remada_curvada.png",
                        description: "Exercício composto para espessura das costas.",
                        videoUrl: "https://musclewiki.com/Barbell/Female/Shoulders/Barbell-Upright-Row",
                        muscleGroup: "Costas, Bíceps"
                    },
                    {
                        name: "Remada aberta", sets: 3, reps: "8-10",
                        image: "./images/remada_aberta.png",
                        description: "Foco na parte superior das costas e trapézio.",
                        videoUrl: "https://musclewiki.com/barbell/male/lats/barbell-bent-over-row/",
                        muscleGroup: "Costas"
                    },
                    {
                        name: "Rosca scott", sets: 3, reps: "8-12",
                        image: "./images/rosca_scott.png",
                        description: "Isolamento do bíceps, com apoio para evitar roubo.",
                        videoUrl: "https://musclewiki.com/pt-br/barbell/male/biceps/ez-bar-reverse-preacher-curl",
                        muscleGroup: "Bíceps"
                    },
                    {
                        name: "Rosca no banco inclinado", sets: 2, reps: "8-12",
                        image: "./images/rosca_banco_inclinado.png",
                        description: "Alongamento máximo do bíceps, ideal para pico.",
                        videoUrl: "https://musclewiki.com/dumbbells/male/shoulders/dumbbell-seated-single-arm-arnold-press",
                        muscleGroup: "Bíceps"
                    },
                    {
                        name: "Elevação frontal", sets: 3, reps: "10-12",
                        image: "./images/elevacao_frontal.png",
                        description: "Foco na parte anterior do ombro.",
                        videoUrl: "https://musclewiki.com/dumbbells/male/shoulders/dumbbell-front-raise/",
                        muscleGroup: "Ombro"
                    },
                    {
                        name: "Remada alta", sets: 3, reps: "8-10",
                        image: "./images/remada_alta.png",
                        description: "Trabalha os trapézios e deltoides laterais.",
                        videoUrl: "https://musclewiki.com/barbell/male/traps/barbell-upright-row/",
                        muscleGroup: "Ombro, Trapézio"
                    }
                ]
            },
            {
                day: 3,
                title: "Pernas completo 1",
                image: "https://images.unsplash.com/photo-1594915447192-d62153549646?q=80&w=1770&auto=format&fit=crop&ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D",
                exercises: [
                    {
                        name: "Agachamento livre", sets: 4, reps: "6-8",
                        image: "./images/agachamento_livre.png",
                        description: "Exercício fundamental para pernas e glúteos.",
                        videoUrl: "https://musclewiki.com/barbell/male/quadriceps/barbell-back-squat/",
                        muscleGroup: "Pernas, Glúteos"
                    },
                    {
                        name: "Stiff com barra", sets: 3, reps: "6-8",
                        image: "./images/stiff_barra.png",
                        description: "Trabalha isquiotibiais e glúteos, com foco na posterior.",
                        videoUrl: "https://musclewiki.com/barbell/male/gluteus-maximus/barbell-stiff-leg-deadlifts",
                        muscleGroup: "Isquiotibiais, Glúteos"
                    },
                    {
                        name: "Cadeira extensora", sets: 3, reps: "8-12",
                        image: "./images/cadeira_extensora.png",
                        description: "Isolamento do quadríceps.",
                        videoUrl: "https://totalpass.com/br/blog/atividade-fisica/cadeira-extensora-o-que-e-e-como-fazer/",
                        muscleGroup: "Quadríceps"
                    },
                    {
                        name: "Cadeira flexora", sets: 3, reps: "8-12",
                        image: "./images/cadeira_flexora.png",
                        description: "Isolamento dos isquiotibiais.",
                        videoUrl: "https://www.youtube.com/watch?v=e0_xHkXw350",
                        muscleGroup: "Isquiotibiais"
                    },
                    {
                        name: "Afundo com halteres", sets: 3, reps: "8-10",
                        image: "./images/afundo_halteres.png",
                        description: "Exercício unilateral para pernas e glúteos.",
                        videoUrl: "https://musclewiki.com/dumbbells/male/quadriceps/dumbbell-lunges/",
                        muscleGroup: "Pernas, Glúteos"
                    },
                    {
                        name: "Panturrilha no leg press", sets: 4, reps: "15-20",
                        image: "./images/panturrilha_legpress.png",
                        description: "Amplitude maior para trabalhar a panturrilha.",
                        videoUrl: "https://www.youtube.com/watch?v=Gf7B6Mr4fC4",
                        muscleGroup: "Panturrilha"
                    },
                    {
                        name: "Panturrilha sentado", sets: 4, reps: "15-20",
                        image: "./images/panturrilha_sentado.png",
                        description: "Foco no sóleo (parte inferior da panturrilha).",
                        videoUrl: "https://www.youtube.com/watch?v=Bx6elAOgxMI",
                        muscleGroup: "Panturrilha"
                    },                  
                    {
                        name: "Panturrilha em pé", sets: 4, reps: "15-20",
                        image: "./images/panturrilha_pe.png",
                        description: "Foco no gastrocnêmio (parte superior da panturrilha).",
                        videoUrl: "https://musclewiki.com/bodyweight/male/calves/standing-calf-raise/",
                        muscleGroup: "Panturrilha"
                    },
                    {
                        name: "Abdominal supra", sets: 3, reps: "12-15",
                        image: "./images/abdominal_supra.png",
                        description: "Trabalha a parte superior do abdômen.",
                        videoUrl: "https://musclewiki.com/bodyweight/male/abdominals/2",
                        muscleGroup: "Abdômen"
                    }
                ]
            },
            {
                day: 4,
                title: "Superiores completo e antebraço",
                image: "https://images.unsplash.com/photo-1541592106381-b31649479354?q=80&w=1770&auto=format&fit=crop&ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D",
                exercises: [
                    {
                        name: "Supino máquina", sets: 3, reps: "6-8",
                        image: "./images/supino_maquina.png",
                        description: "Foco no peitoral e ombros, com segurança da máquina.",
                        videoUrl: "https://musclewiki.com/exercises/female/chest",
                        muscleGroup: "Peito, Ombro, Tríceps"
                    },
                    {
                        name: "Supino inclinado", sets: 2, reps: "8-10",
                        image: "./images/supino_inclinado.png",
                        description: "Variação para a parte superior do peito.",
                        videoUrl: "https://musclewiki.com/barbell/male/anterior-deltoid/barbell-incline-bench-press/",
                        muscleGroup: "Peito (Superior), Ombro, Tríceps"
                    },
                    {
                        name: "Puxada triângulo", sets: 3, reps: "6-8",
                        image: "./images/puxada_triangulo.png",
                        description: "Trabalha a largura das costas, com foco nos dorsais.",
                        videoUrl: "https://musclewiki.com/barbell/male/biceps/barbell-bent-over-row",
                        muscleGroup: "Costas, Bíceps"
                    },
                    {
                        name: "Remada aberta", sets: 2, reps: "8-10",
                        image: "./images/remada_aberta.png",
                        description: "Foco na parte superior das costas e trapézio.",
                        videoUrl: "https://musclewiki.com/barbell/male/lats/barbell-bent-over-row/",
                        muscleGroup: "Costas"
                    },
                    {
                        name: "Desenvolvimento Arnold", sets: 3, reps: "8-10",
                        image: "./images/desenvolvimento_arnold.png",
                        description: "Variação completa para ombros com rotação.",
                        videoUrl: "https://musclewiki.com/dumbbells/male/shoulders/dumbbell-arnold-press/",
                        muscleGroup: "Ombro"
                    },
                    {
                        name: "Elevação lateral inclinada", sets: 3, reps: "10-12",
                        image: "./images/elevacao_lateral_inclinada.png",
                        description: "Maior ênfase na parte posterior do deltoide.",
                        videoUrl: "https://www.youtube.com/watch?v=Z2G8DBaT9U4",
                        muscleGroup: "Ombro"
                    },
                    {
                        name: "Tríceps na polia", sets: 2, reps: "8-12",
                        image: "./images/triceps_polia.png",
                        description: "Variação para o tríceps, com foco na contração.",
                        videoUrl: "https://www.youtube.com/watch?v=dQw4w9WgXcQ",
                        muscleGroup: "Tríceps"
                    },
                    {
                        name: "Rosca punho inversa", sets: 3, reps: "12-15",
                        image: "./images/rosca_punho_inversa.png",
                        description: "Fortalecimento dos extensores do antebraço.",
                        videoUrl: "https://www.youtube.com/watch?v=EA7u4Q_8j0I",
                        muscleGroup: "Antebraço"
                    },
                    {
                        name: "Rosca punho", sets: 3, reps: "12-15",
                        image: "./images/rosca_punho.png",
                        description: "Fortalecimento dos flexores do antebraço.",
                        videoUrl: "https://www.youtube.com/watch?v=EA7u4Q_8j0I",
                        muscleGroup: "Antebraço"
                    }
                ]
            },
            {
                day: 5,
                title: "Pernas completo 2",
                image: "https://images.unsplash.com/photo-1594915447192-d62153549646?q=80&w=1770&auto=format&fit=crop&ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D",
                exercises: [
                    {
                        name: "Leg press 45°", sets: 4, reps: "6-8",
                        image: "./images/leg_press.png",
                        description: "Exercício composto para pernas, com foco em quadríceps e glúteos.",
                        videoUrl: "https://gears.com.br/produto/leg-press-45-gym-line-gears/",
                        muscleGroup: "Pernas, Glúteos"
                    },
                    {
                        name: "Cadeira flexora", sets: 3, reps: "6-10",
                        image: "./images/cadeira_flexora.png",
                        description: "Isolamento dos isquiotibiais.",
                        videoUrl: "https://www.youtube.com/watch?v=e0_xHkXw350",
                        muscleGroup: "Isquiotibiais"
                    },
                    {
                        name: "Cadeira extensora", sets: 3, reps: "8-12",
                        image: "./images/cadeira_extensora.png",
                        description: "Isolamento do quadríceps.",
                        videoUrl: "https://totalpass.com/br/blog/atividade-fisica/cadeira-extensora-o-que-e-e-como-fazer/",
                        muscleGroup: "Quadríceps"
                    },
                    {
                        name: "Mesa flexora", sets: 3, reps: "8-12",
                        image: "./images/mesa_flexora.png",
                        description: "Outra opção para isolar os isquiotibiais, deitado.",
                        videoUrl: "https://www.tuasaude.com/mesa-flexora/",
                        muscleGroup: "Isquiotibiais"
                    },
                    {
                        name: "Agachamento búlgaro", sets: 3, reps: "8-10",
                        image: "./images/agachamento_bulgaro.png",
                        description: "Exercício unilateral intenso para pernas e glúteos.",
                        videoUrl: "https://musclewiki.com/dumbbells/male/quadriceps/dumbbell-bulgarian-split-squat/",
                        muscleGroup: "Pernas, Glúteos"
                    },
                    {
                        name: "Panturrilha unilateral", sets: 4, reps: "12-15",
                        image: "./images/panturrilha_unilateral.png",
                        description: "Trabalho individualizado para cada panturrilha.",
                        videoUrl: "https://www.youtube.com/watch?v=9CPrrmusOu8",
                        muscleGroup: "Panturrilha"
                    },
                    {
                        name: "Panturrilha no burrinho", sets: 4, reps: "15-20",
                        image: "./images/panturrilha_burrinho.png",
                        description: "Exercício tradicional com foco na amplitude.",
                        videoUrl: "https://www.youtube.com/watch?v=JbyjNymZOt0",
                        muscleGroup: "Panturrilha"
                    },
                    {
                        name: "Panturrilha no smith", sets: 4, reps: "15-20",
                        image: "./images/panturrilha_smith.png",
                        description: "Fortalecimento da panturrilha com estabilidade.",
                        videoUrl: "https://musclewiki.com/exercises/male/soleus",
                        muscleGroup: "Panturrilha"
                    },
                    {
                        name: "Abdominal máquina", sets: 3, reps: "12-15",
                        image: "./images/abdominal_maquina.png",
                        description: "Trabalha o abdômen com assistência da máquina.",
                        videoUrl: "https://www.youtube.com/watch?v=4SR93vi2ZKw&pp=0gcJCdgAo7VqN5tD",
                        muscleGroup: "Abdômen"
                    }
                ]
            }
        ];

        function showCustomAlert(message, type) {
            const alertDiv = document.createElement('div');
            alertDiv.className = `alert alert-${type}`;
            alertDiv.textContent = message;
            alertContainer.appendChild(alertDiv);

            setTimeout(() => {
                alertDiv.classList.add('show');
            }, 10); // Small delay to trigger CSS transition

            setTimeout(() => {
                alertDiv.classList.remove('show');
                alertDiv.addEventListener('transitionend', () => alertDiv.remove());
            }, 3000);
        }

        function initWorkoutDays() {
            workoutDaysContainer.innerHTML = '';
            // Iterate over the workoutData array
            workoutData.forEach(dayObj => {
                const dayCard = document.createElement('div');
                dayCard.className = 'day-card';
                // Display "Dia X" and the title
                dayCard.innerHTML = `Dia ${dayObj.day}<br><span>${dayObj.title}</span>`;
                
                // Check completion based on the numerical day
                if (workoutHistory.some(h => h.day === dayObj.day && h.date === getTodayDate())) {
                    dayCard.classList.add('completed');
                }
                // Pass the numerical day to selectDay
                dayCard.addEventListener('click', () => selectDay(dayObj.day));
                workoutDaysContainer.appendChild(dayCard);
            });
            registerWorkoutButton.style.display = 'none';
        }

        function getTodayDate() {
            const today = new Date();
            return today.toISOString().split('T')[0]; //YYYY-MM-DD
        }

        function selectDay(dayNumber) { // Changed parameter name to reflect it's a number
            currentDay = dayNumber;
            // Find the workout object based on the numerical day
            const selectedWorkout = workoutData.find(w => w.day === dayNumber);
            if (!selectedWorkout) {
                console.error(`Workout for day ${dayNumber} not found.`);
                showCustomAlert(`Treino para o Dia ${dayNumber} não encontrado.`, 'danger');
                return;
            }

            currentDayName.textContent = `Dia ${selectedWorkout.day} - ${selectedWorkout.title}`;
            daysView.style.display = 'none';
            exercisesView.style.display = 'flex'; // Use flex for proper layout
            backButton.style.display = 'block';
            registerWorkoutButton.style.display = 'block';

            // Load progress for the selected day from localStorage
            const savedProgress = workoutProgress[currentDay] || {};
            currentExercises = selectedWorkout.exercises.map(exercise => ({
                ...exercise,
                completed: savedProgress[exercise.name] ? savedProgress[exercise.name].completed : false
            }));

            renderExercises();
            updateNextExerciseDisplay(); // Initial display of next exercise
        }

        function renderExercises() {
            exerciseList.innerHTML = '';
            currentExercises.forEach((exercise, index) => {
                const listItem = document.createElement('li');
                listItem.className = 'exercise-item';
                if (exercise.completed) {
                    listItem.classList.add('completed');
                }

                // Adicionado a tag <img> com o caminho local da imagem
                // Adicionado descrição, grupo muscular e link de vídeo
                listItem.innerHTML = `
                    ${exercise.image ? `<img src="${exercise.image}" alt="${exercise.name}" class="exercise-img" onerror="this.onerror=null;this.src='https://placehold.co/80x80/cccccc/000000?text=No+Image';">` : ''}
                    <div class="exercise-details">
                        <h3>${exercise.name}</h3>
                        <p>Séries: ${exercise.sets}, Repetições: ${exercise.reps}</p>
                        <p>Descanso: ${exercise.rest ? `${exercise.rest} segundos` : 'N/A'}</p>
                        ${exercise.description ? `<p class="description">${exercise.description}</p>` : ''}
                        ${exercise.muscleGroup ? `<p class="muscle-group">Músculos: ${exercise.muscleGroup}</p>` : ''}
                        ${exercise.videoUrl ? `<a href="${exercise.videoUrl}" target="_blank" class="video-link">Ver Vídeo</a>` : ''}
                    </div>
                    <div class="exercise-actions">
                        ${!exercise.completed ? `<button class="btn btn-success" data-index="${index}">Marcar como Concluído</button>` : ''}
                    </div>
                `;
                exerciseList.appendChild(listItem);
            });

            document.querySelectorAll('.exercise-actions .btn-success').forEach(button => {
                button.addEventListener('click', (event) => {
                    const index = parseInt(event.target.dataset.index);
                    markAsDone(index);
                });
            });
        }

        function markAsDone(index) {
            if (index >= 0 && index < currentExercises.length) {
                currentExercises[index].completed = true;
                saveProgress();
                renderExercises(); // Re-render exercises to update UI
                // Only start timer if there's a rest value
                if (currentExercises[index].rest) {
                    startRestTimer(currentExercises[index].rest);
                } else {
                    showCustomAlert(`${currentExercises[index].name} concluído!`, 'success');
                }
                updateNextExerciseDisplay(); // Update next exercise after one is completed
            }
        }

        function updateTimerDisplay() {
            const minutes = Math.floor(secondsRemaining / 60);
            const seconds = secondsRemaining % 60;
            countdownElement.textContent = `${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
        }


        function startRestTimer(duration) {
            clearInterval(timerInterval);
            secondsRemaining = duration;
            resting = true;
            timerElement.classList.add('resting');
            timerElement.style.display = 'block';
            updateTimerDisplay();

            timerInterval = setInterval(() => {
                secondsRemaining--;
                updateTimerDisplay();
                if (secondsRemaining <= 0) {
                    clearInterval(timerInterval);
                    resting = false;
                    timerElement.classList.remove('resting');
                    showCustomAlert("Descanso finalizado! Próximo exercício.", 'info');
                    // Optionally hide timer or keep it at 00:00
                    // timerElement.style.display = 'none';
                }
            }, 1000);
        }

        skipRestButton.addEventListener('click', () => {
            clearInterval(timerInterval);
            secondsRemaining = 0;
            resting = false;
            timerElement.classList.remove('resting');
            updateTimerDisplay();
            showCustomAlert("Descanso pulado.", 'info');
            // timerElement.style.display = 'none'; // You might want to hide it
        });

        add30SecButton.addEventListener('click', () => {
            secondsRemaining += 30;
            updateTimerDisplay();
            showCustomAlert("+30 segundos de descanso.", 'info');
        });


        function saveProgress() {
            if (currentDay) {
                workoutProgress[currentDay] = {};
                currentExercises.forEach(ex => {
                    workoutProgress[currentDay][ex.name] = { completed: ex.completed };
                });
                localStorage.setItem('workoutProgress', JSON.stringify(workoutProgress));
            }
        }

        function registerWorkout() {
            if (!currentDay) {
                showCustomAlert("Nenhum dia de treino selecionado.", 'danger');
                return;
            }

            const allExercisesCompleted = currentExercises.every(ex => ex.completed);
            if (!allExercisesCompleted) {
                showCustomAlert("Nem todos os exercícios foram concluídos. Conclua-os ou continue depois.", 'info');
                // return; // Allow registering even if not all completed, or uncomment to enforce
            }

            const todayDate = getTodayDate();
            const existingEntryIndex = workoutHistory.findIndex(h => h.day === currentDay && h.date === todayDate);

            const workoutDataEntry = { // Use a different name to avoid conflict with the global workoutData array
                day: currentDay,
                date: todayDate,
                exercises: currentExercises.map(ex => ({
                    name: ex.name,
                    completed: ex.completed,
                    sets: ex.sets,
                    reps: ex.reps
                })),
                completedAll: allExercisesCompleted,
                registeredAt: new Date().toISOString()
            };

            if (existingEntryIndex > -1) {
                workoutHistory[existingEntryIndex] = workoutDataEntry;
                showCustomAlert("Treino do dia atualizado no histórico!", 'info');
            } else {
                workoutHistory.push(workoutDataEntry);
                showCustomAlert("Treino do dia registrado no histórico!", 'success');
            }

            try {
                localStorage.setItem('workoutHistory', JSON.stringify(workoutHistory));
                // Clear individual exercise progress for the day after registration,
                // so it resets for the next time the same day is selected (e.g., next week)
                if (workoutProgress[currentDay]) {
                    delete workoutProgress[currentDay];
                    localStorage.setItem('workoutProgress', JSON.stringify(workoutProgress));
                }
                showCustomAlert("Treino registrado com sucesso!", 'success');
            } catch (e) {
                console.error("Erro ao salvar histórico:", e);
                showCustomAlert("Erro ao registrar treino.", 'danger');
            }

            initWorkoutDays();
        }

        // Event listeners
        registerWorkoutButton.addEventListener('click', registerWorkout);
        backButton.addEventListener('click', () => {
            daysView.style.display = 'block';
            exercisesView.style.display = 'none';
            backButton.style.display = 'none';
            timerElement.style.display = 'none';
            nextExerciseDisplay.style.display = 'none'; // Hide next exercise display
            clearInterval(timerInterval);
            resting = false;
            secondsRemaining = 0;
            currentDay = null;
        });

        // Inicialização
        function initApp() {
            try {
                workoutProgress = JSON.parse(localStorage.getItem('workoutProgress')) || {};
                workoutHistory = JSON.parse(localStorage.getItem('workoutHistory')) || [];
            } catch (e) {
                console.error("Erro ao carregar dados:", e);
                workoutProgress = {};
                workoutHistory = [];
            }

            initWorkoutDays();
            exercisesView.style.display = 'none';
            backButton.style.display = 'none';
            timerElement.style.display = 'none';
            nextExerciseDisplay.style.display = 'none'; // Ensure it's hidden on initial load
        }

        document.addEventListener('DOMContentLoaded', initApp);
    </script>
</body>
</html>
